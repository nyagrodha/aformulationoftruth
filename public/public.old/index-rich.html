<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>a 4mulationoftruth</title>

  <style>
  @font-face{
    font-family: 'SaiIndira';
    src: url('/var/www/aformulationoftruth/frontend/assets/fonts/SaiIndira.woff2') format('woff2');
    font-display: swap;
  }


  <style>
    a, a:hover, a:focus, a:active, a:visited { text-decoration: none; }
    body{
      margin:0; height:100vh; background:#000011; display:flex; align-items:center; justify-content:center; flex-direction:column; overflow:hidden;
    }
    .tamil-container{ text-align:center; position:relative; }
    .tamil-neon{
      font-family:'SaiIndira','Baloo Thambi 2','Noto Sans Tamil',serif;
      font-size:3vw; color:#ff8c00;
      text-shadow:0 0 2.5px #ff69b4,0 0 5px #ff69b4,0 0 8px #ff1493,0 0 15px #ff69b4,0 0 25px #4169e1;
      transition:transform 1s ease, text-shadow 1s ease;
      text-align:center; padding:2rem; line-height:1.2;
    }
    .tamil-neon:hover{
      transform:scale(1.45);
      text-shadow:0 0 13px #ff69b4,0 0 28px #ff69b4,0 0 56px #ff1493,0 0 83px #ff69b4,0 0 120px #4169e1;
    }
    .first-line{ display:block; opacity:1; }
    .second-line{ display:block; opacity:1; margin-top:.5rem; transition:opacity .6s ease-out, transform .3s ease-out;}
    .second-line.fade-out{ opacity:0; transform:translateY(20px) scale(.9); }

    .single-line-phrases{ display:block; opacity:0; transition:opacity .6s ease-in; }
    .single-line-phrases.show{ opacity:1; }

    .right-words{ display:inline-block; transition:opacity .4s ease, transform .35s ease; }
    .right-words.fade-out{ opacity:0; transform:translateY(8px) scale(.92); }
    .right-words.incarnation{ opacity:1; transform:translateY(0) scale(1.1); }

    .questionnaire-link{
      font-family:Arial, sans-serif; font-size:1.8vw; color:#9370db;
      text-shadow:0 0 3px #9370db,0 0 6px #8a2be2,0 0 12px #9370db,0 0 20px #4b0082,0 0 35px #9370db;
      position:fixed; top:60%; left:50%; transform:translate(-50%,-50%); opacity:0; transition:all 2s ease-in-out;
      padding:1rem 2rem; border:2px solid transparent; border-radius:12px; cursor:pointer; z-index:100; background:rgba(147,112,219,.05);
    }
    .questionnaire-link.appear{ opacity:.7; transform:translate(-50%,-50%) scale(1); }
    .questionnaire-link.foreground{
      opacity:1; font-size:2.2vw; transform:translate(-50%,-50%) scale(1.2);
      text-shadow:0 0 8px #9370db,0 0 15px #8a2be2,0 0 25px #9370db,0 0 40px #4b0082,0 0 60px #9370db;
      border-color:#9370db; background:rgba(147,112,219,.15);
      box-shadow:0 0 20px rgba(147,112,219,.3), 0 0 40px rgba(147,112,219,.2);
    }
    .questionnaire-link:hover{
      opacity:1; transform:translate(-50%,-50%) scale(1.3);
      text-shadow:0 0 10px #9370db,0 0 20px #8a2be2,0 0 35px #9370db,0 0 50px #4b0082,0 0 80px #9370db;
      border-color:#bb86fc; background:rgba(147,112,219,.25);
      box-shadow:0 0 30px rgba(147,112,219,.5), 0 0 60px rgba(147,112,219,.3);
    }
    .questionnaire-link.portal-rush{ animation:portalRush 1.5s ease-in forwards; pointer-events:none; }
    @keyframes portalRush{
      0%{ transform:translate(-50%,-50%) scale(1.3); opacity:1; border-radius:12px; }
      30%{ transform:translate(-50%,-50%) scale(2); opacity:.9; border-radius:20px; }
      60%{ transform:translate(-50%,-50%) scale(5); opacity:.7; border-radius:50px; background:rgba(147,112,219,.4); }
      80%{ transform:translate(-50%,-50%) scale(12); opacity:.3; border-radius:100px; background:rgba(147,112,219,.6); }
      100%{ transform:translate(-50%,-50%) scale(25); opacity:0; border-radius:200px; background:rgba(147,112,219,.8); }
    }

    .email-portal{
      position:fixed; top:50%; left:50%; transform:translate(-50%,-50%) scale(0); opacity:0; z-index:200;
      background:rgba(147,112,219,.9); border:2px solid #9370db; border-radius:15px; padding:2rem; text-align:center;
      transition:all 1s ease-out; backdrop-filter:blur(10px);
    }
    .email-portal.appear{ transform:translate(-50%,-50%) scale(1); opacity:1; }
    .email-portal input{
      background:rgba(0,0,17,.8); border:1px solid #9370db; color:#fff; padding:1rem; font-size:1.2rem; border-radius:8px; text-align:center; margin:1rem 0; width:300px; outline:none;
    }
    .email-portal input:focus{ border-color:#bb86fc; box-shadow:0 0 15px rgba(147,112,219,.5); }
    .email-portal button{
      background:#9370db; border:none; color:#fff; padding:1rem 2rem; font-size:1.1rem; border-radius:8px; cursor:pointer; margin-top:1rem; transition:all .3s ease;
    }
    .email-portal button:hover{ background:#bb86fc; box-shadow:0 0 20px rgba(147,112,219,.6); }

    .tamil-container.keep-glowing{ opacity:.6; transform:scale(.9); transition:all 3s ease-out; }

    /* Tiny SoundCloud player (bottom-right) */
    .sc-mini{
      position:fixed; right:12px; bottom:12px; width:200px; height:60px; z-index:9999;
      box-shadow:0 2px 12px rgba(0,0,0,.35); border-radius:8px; overflow:hidden;
    }
    .sc-mini iframe{ width:100%; height:100%; border:0; }
    @media (max-width:480px){ .sc-mini{ display:none; } }

    /* Transliteration tooltip */
    .tamil-word{ position:relative; cursor:help; }
    .tamil-word::after{
      content:attr(data-transliteration);
      position:absolute; bottom:120%; left:50%; transform:translateX(-50%);
      background:rgba(0,0,0,.9); color:#fff; padding:8px 12px; border-radius:6px;
      font-family:Arial,sans-serif; font-size:.7em; text-shadow:none; white-space:nowrap; opacity:0; visibility:hidden; transition:opacity .3s ease, visibility .3s ease;
      z-index:1000; border:1px solid #9370db; box-shadow:0 0 10px rgba(147,112,219,.5);
    }
    .tamil-word::before{
      content:''; position:absolute; bottom:110%; left:50%; transform:translateX(-50%);
      border:5px solid transparent; border-top-color:rgba(0,0,0,.9); opacity:0; visibility:hidden; transition:opacity .3s ease, visibility .3s ease;
    }
    .tamil-word:hover::after, .tamil-word:hover::before{ opacity:1; visibility:visible; }
  </style>
</head>
<body>
  <div class="tamil-container" id="tamilContainer">
    <div class="tamil-neon">
      <span class="first-line">
        <span class="tamil-word" data-transliteration="aruvamē">அருவமே</span>
        <span class="tamil-word" data-transliteration="uruvam">உருவம்</span>,
      </span>
      <span class="second-line" id="secondLine">
        <span class="tamil-word" data-transliteration="uruvamē">உருவமே</span>
        <span class="tamil-word" data-transliteration="aruvam">அருவம்</span>
      </span>

      <!-- Single-line area used after fade; we'll only use #rightWords -->
      <span class="single-line-phrases" id="singleLinePhrases" style="display:none;">
        <span class="right-words" id="rightWords"></span>
      </span>
    </div>
  </div>

  <a href="#" class="questionnaire-link" id="questionnaireLink">begin the questionnaire</a>

  <div class="email-portal" id="emailPortal">
    <h3 style="color:#fff; margin-bottom:1rem; font-family:Arial,sans-serif;">enter the truth</h3>
    <input type="email" id="emailInput" placeholder="your email address" required>
    <br>
    <button onclick="enterQuestionnaire()">proceed into the questions</button>
  </div>

  <!-- Tiny, auto-playing SoundCloud (your Boris – REM track) -->
  <div class="sc-mini" aria-hidden="true">
    <iframe
      allow="autoplay"
      src="https://w.soundcloud.com/player/?url=https%3A//api.soundcloud.com/tracks/300031074&auto_play=true&visual=false&hide_related=true&show_comments=false&show_user=false&show_reposts=false&show_teaser=false">
    </iframe>
  </div>

  <script>
    const secondLine = document.getElementById('secondLine');
    const singleLinePhrases = document.getElementById('singleLinePhrases');
    const rightWords = document.getElementById('rightWords');
    const tamilContainer = document.getElementById('tamilContainer');
    const questionnaireLink = document.getElementById('questionnaireLink');

    // Neon palette
    const primaryNeonColors = ['#ff0000','#00ff00','#00ffff','#ffff00','#ff00ff'];

    // Phrase templates
    const phraseUruvamAruvam = `
      <span class="tamil-word" data-transliteration="uruvamē">உருவமே</span>
      <span class="tamil-word" data-transliteration="aruvam">அருவம்</span>
    `;
    const phraseAruvamUruvam = `
      <span class="tamil-word" data-transliteration="aruvamē">அருவமே</span>
      <span class="tamil-word" data-transliteration="uruvam">உருவம்</span>
    `;

    // Flicker helper
    function neonShadow(color){
      const intensity = Math.random()*40 + 20; // 20–60
      const flicker = Math.random()*4 + 8;    // 5–20
      return `
        0 0 ${intensity*0.1}px ${color},
        0 0 ${intensity*0.2}px ${color},
        0 0 ${intensity*0.4}px ${color},
        0 0 ${intensity*0.8}px ${color},
        0 0 ${intensity*1.2}px ${color},
        0 0 ${intensity*2}px ${color},
        0 0 ${flicker}px ${color}
      `;
    }

    // After ~13s, fade out second line, then start alternating
    setTimeout(() => {
      secondLine.classList.add('fade-out');

      setTimeout(() => {
        secondLine.style.display = 'none';
        singleLinePhrases.style.display = 'block';
        singleLinePhrases.classList.add('show');

        // Start alternating
        let showFirst = true;
        function swap(){
          // fade out current
          rightWords.classList.remove('incarnation');
          rightWords.classList.add('fade-out');

          setTimeout(() => {
            // swap text
            rightWords.innerHTML = showFirst ? phraseUruvamAruvam : phraseAruvamUruvam;
            showFirst = !showFirst;

            // apply neon flicker each time
            const c = primaryNeonColors[Math.floor(Math.random()*primaryNeonColors.length)];
            rightWords.style.color = c;
            rightWords.style.textShadow = neonShadow(c);

            // bring it in
            rightWords.classList.remove('fade-out');
            rightWords.classList.add('incarnation');
          }, 200);
        }

        // Seed first phrase immediately, then alternate
        rightWords.innerHTML = phraseUruvamAruvam;
        const seedColor = '#ff69b4';
        rightWords.style.color = seedColor;
        rightWords.style.textShadow = neonShadow(seedColor);
        rightWords.classList.add('incarnation');

        // Begin the loop
        setInterval(swap, 1600);

        // Reveal the button a few seconds later
        setTimeout(() => {
          tamilContainer.classList.add('keep-glowing');
          questionnaireLink.classList.add('appear');
          setTimeout(() => questionnaireLink.classList.add('foreground'), 3000);
        }, 5000);

      }, 600); // wait for fade
    }, 13000); // <-- ~13 seconds

    // Portal button behavior
    questionnaireLink.addEventListener('click', (e) => {
      e.preventDefault();
      questionnaireLink.classList.add('portal-rush');
      setTimeout(() => document.getElementById('emailPortal').classList.add('appear'), 15000);
    });

    // Redirect to login flow (JWT token-based authentication)
    function enterQuestionnaire(){
      // Check if user already has a valid token
      const token = localStorage.getItem('token');
      if (token) {
        // User is already authenticated, go to questionnaire
        window.location.href = '/questionnaire';
      } else {
        // Redirect to login page to get magic link
        window.location.href = '/login?redirect=/questionnaire';
      }
    }
    window.enterQuestionnaire = enterQuestionnaire;
  </script>
</body>
</html>
