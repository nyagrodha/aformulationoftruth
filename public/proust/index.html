<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>à®•à®°à¯à®ªà¯à®ªà®šà®¾à®®à®¿ à®•à¯‡à®³à¯à®µà®¿à®¤à®¾à®³à¯ â€” Karuppacami Kelvittaal</title>
    <meta name="description" content="A philosophical questionnaire rooted in Kashmir Shaivism and tantric aesthetics. Explore yourself through the questions of Proust, reimagined through the lens of Abhinavagupta's consciousness philosophy.">
    
    <!-- Fonts -->
    <link rel="stylesheet" href="/css/fonts.css">
    
    <style>
        :root {
            --prakasha: #1976D2;
            --vimarsha: #0D47A1;
            --spanda: #E3F2FD;
            --camatkara: #FF6F00;
            --shanta: #37474F;
            --akasha: #FAFAFA;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'League Spartan', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(
                180deg,
                var(--akasha) 0%,
                var(--spanda) 40%,
                var(--prakasha) 100%
            );
            min-height: 100vh;
            color: var(--shanta);
            line-height: 1.8;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 4rem 2rem;
        }

        header {
            text-align: center;
            margin-bottom: 4rem;
        }

        .mantra {
            font-family: 'Sorts Mill Goudy', Georgia, serif;
            font-size: 0.9rem;
            letter-spacing: 0.3em;
            color: var(--prakasha);
            margin-bottom: 1.5rem;
            text-transform: uppercase;
        }

        h1 {
            font-family: 'Sorts Mill Goudy', Georgia, serif;
            font-size: clamp(2.5rem, 6vw, 4rem);
            font-weight: 400;
            color: var(--vimarsha);
            margin-bottom: 1rem;
            line-height: 1.2;
        }

        .subtitle {
            font-size: 1.1rem;
            font-weight: 300;
            color: var(--shanta);
            opacity: 0.9;
        }

        .subtitle .tamil {
            font-size: 1.3rem;
            display: block;
            margin-top: 0.5rem;
            color: var(--prakasha);
        }

        .symbol {
            width: 120px;
            height: 120px;
            margin: 3rem auto;
            position: relative;
        }

        .symbol::before {
            content: 'à¥°';
            font-size: 4rem;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: var(--prakasha);
            animation: breathe 4s ease-in-out infinite;
        }

        @keyframes breathe {
            0%, 100% { 
                opacity: 0.6; 
                transform: translate(-50%, -50%) scale(1);
            }
            50% { 
                opacity: 1; 
                transform: translate(-50%, -50%) scale(1.1);
            }
        }

        .symbol::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border: 2px solid var(--prakasha);
            border-radius: 50%;
            opacity: 0.3;
            animation: pulse 4s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.3; }
            50% { transform: scale(1.2); opacity: 0.1; }
        }

        .content {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 24px;
            padding: 3rem;
            box-shadow: 
                0 4px 6px rgba(0, 0, 0, 0.05),
                0 10px 40px rgba(25, 118, 210, 0.1);
            margin-bottom: 3rem;
        }

        .intro {
            font-family: 'Sorts Mill Goudy', Georgia, serif;
            font-size: 1.3rem;
            font-style: italic;
            text-align: center;
            color: var(--shanta);
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid var(--spanda);
        }

        .description {
            font-size: 1rem;
            color: var(--shanta);
            margin-bottom: 2rem;
        }

        .description p {
            margin-bottom: 1rem;
        }

        .features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin: 2rem 0;
        }

        .feature {
            padding: 1.5rem;
            background: var(--spanda);
            border-radius: 16px;
            text-align: center;
        }

        .feature-icon {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .feature h3 {
            font-family: 'Sorts Mill Goudy', Georgia, serif;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--vimarsha);
            margin-bottom: 0.5rem;
        }

        .feature p {
            font-size: 0.85rem;
            color: var(--shanta);
            opacity: 0.8;
        }

        /* Sign-in form */
        .sign-in-form {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
            margin: 1rem 0 0.5rem;
        }

        .sign-in-form input[type="email"] {
            padding: 0.75rem 1rem;
            border: 1px solid var(--prakasha);
            border-radius: 8px;
            font-family: 'League Spartan', sans-serif;
            font-size: 0.95rem;
            background: white;
            color: var(--shanta);
            outline: none;
            transition: border-color 0.2s ease, box-shadow 0.2s ease;
        }

        .sign-in-form input[type="email"]:focus {
            border-color: var(--vimarsha);
            box-shadow: 0 0 0 3px rgba(25, 118, 210, 0.1);
        }

        .sign-in-form button {
            padding: 0.75rem 1rem;
            background: linear-gradient(135deg, var(--prakasha), var(--vimarsha));
            color: white;
            border: none;
            border-radius: 8px;
            font-family: 'League Spartan', sans-serif;
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .sign-in-form button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(25, 118, 210, 0.3);
        }

        .sign-in-form button:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
        }

        .sign-in-note {
            font-size: 0.75rem !important;
            opacity: 0.6 !important;
            margin-top: 0.25rem;
        }

        .sign-in-message {
            font-size: 0.85rem;
            padding: 0.5rem;
            border-radius: 6px;
            margin-top: 0.5rem;
        }

        .sign-in-message.success {
            background: rgba(76, 175, 80, 0.1);
            color: #2e7d32;
        }

        .sign-in-message.error {
            background: rgba(244, 67, 54, 0.1);
            color: #c62828;
        }

        .languages {
            text-align: center;
            margin: 2rem 0;
            padding: 1.5rem;
            background: linear-gradient(90deg, transparent, var(--spanda), transparent);
            border-radius: 12px;
        }

        .languages h4 {
            font-family: 'Sorts Mill Goudy', Georgia, serif;
            font-size: 0.9rem;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: var(--prakasha);
            margin-bottom: 0.75rem;
        }

        .language-list {
            font-size: 0.95rem;
            color: var(--shanta);
        }

        .cta-section {
            text-align: center;
            margin-top: 2rem;
        }

        .cta-button {
            display: inline-block;
            background: linear-gradient(135deg, var(--prakasha), var(--vimarsha));
            color: white;
            font-family: 'League Spartan', sans-serif;
            font-size: 1rem;
            font-weight: 500;
            padding: 1rem 2.5rem;
            border-radius: 50px;
            text-decoration: none;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(25, 118, 210, 0.3);
        }

        .cta-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(25, 118, 210, 0.4);
        }

        .cta-note {
            font-size: 0.85rem;
            color: var(--shanta);
            opacity: 0.7;
            margin-top: 1rem;
        }

        footer {
            text-align: center;
            padding: 2rem;
            color: white;
        }

        .sanskrit-verse {
            font-family: 'Sorts Mill Goudy', Georgia, serif;
            font-size: 1.1rem;
            font-style: italic;
            margin-bottom: 0.5rem;
            opacity: 0.9;
        }

        /* Abhinavagupta quotes section */
        .abhinava-quotes {
            margin: 2.5rem 0;
            padding: 2rem 0;
            border-top: 1px solid var(--spanda);
            border-bottom: 1px solid var(--spanda);
        }

        .abhinava-quotes h4 {
            font-family: 'League Spartan', sans-serif;
            font-size: 0.8rem;
            letter-spacing: 0.2em;
            text-transform: uppercase;
            color: var(--prakasha);
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .quote-block {
            text-align: center;
            margin-bottom: 2rem;
        }

        .quote-block:last-child {
            margin-bottom: 0;
        }

        .sharada {
            font-family: 'Noto Sans Sharada', serif;
            font-size: 1.6rem;
            color: var(--vimarsha);
            line-height: 1.6;
            margin-bottom: 0.5rem;
        }

        .iast {
            font-family: 'Noto Serif', Georgia, serif;
            font-size: 1.1rem;
            font-style: italic;
            color: var(--shanta);
            margin-bottom: 0.5rem;
        }

        .quote-translation {
            font-family: 'Sorts Mill Goudy', Georgia, serif;
            font-size: 0.95rem;
            color: var(--shanta);
            opacity: 0.85;
            max-width: 500px;
            margin: 0 auto;
        }

        .quote-source {
            font-size: 0.8rem;
            color: var(--prakasha);
            margin-top: 0.5rem;
            font-style: italic;
        }

        /* Footnotes */
        .footnote-ref {
            font-size: 0.75em;
            vertical-align: super;
            color: var(--prakasha);
            text-decoration: none;
            cursor: help;
        }

        .footnotes {
            margin-top: 2rem;
            padding-top: 1.5rem;
            border-top: 1px solid var(--spanda);
            font-size: 0.85rem;
            color: var(--shanta);
            opacity: 0.85;
        }

        .footnotes ol {
            padding-left: 1.5rem;
        }

        .footnotes li {
            margin-bottom: 0.75rem;
        }

        .verse-translation {
            font-size: 0.85rem;
            opacity: 0.7;
        }

        .attribution {
            margin-top: 2rem;
            font-size: 0.8rem;
            opacity: 0.6;
        }

        @media (max-width: 600px) {
            .container {
                padding: 2rem 1rem;
            }

            .content {
                padding: 2rem 1.5rem;
            }

            .features {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <p class="mantra">à¥¥ à¤ªà¥à¤°à¤¤à¥à¤¯à¤­à¤¿à¤œà¥à¤à¤¾ à¥¥</p>
            <h1>Karuppacami Kelvittaal</h1>
            <p class="subtitle">
                A Philosophical Questionnaire
                <span class="tamil">à®•à®°à¯à®ªà¯à®ªà®šà®¾à®®à®¿ à®•à¯‡à®³à¯à®µà®¿à®¤à®¾à®³à¯</span>
            </p>
            <div class="symbol"></div>
        </header>

        <main class="content">
            <p class="intro">
                "Any word arising out of his mouth is the extraordinary mantra; 
                any standing of his body is precisely mudrÄ..."
                <br>
                <small>â€” Abhinavagupta, Anubhavavinivedana</small>
            </p>

            <!-- Abhinavagupta Quotes -->
            <div class="abhinava-quotes">
                <h4>From the Masters</h4>

                <div class="quote-block">
                    <p class="sharada">ğ‘†–ğ‘†´ğ‘† ğ‘†´ğ‘†‚ ğ‘†±ğ‘‡€ğ‘†®ğ‘† ğ‘†¤ğ‘‡€ğ‘† ğ‘‡€ğ‘†«ğ‘†³ ğ‘†®ğ‘†´ğ‘†¯ğ‘‡€ğ‘†®ğ‘†±ğ‘†´ğ‘†¢ğ‘‡€ğ‘†£ğ‘†´ğ‘†²ğ‘†¼ğ‘† ğ‘†¶ğ‘†‚</p>
                    <p class="iast">citiá¸¥ svatantrÄ viÅ›vasiddhihetuá¸¥</p>
                    <p class="quote-translation">"Free thought is the means to perfect everything in the world."</p>
                    <p class="quote-source">â€” PratyabhijÃ±Ähá¹›dayam, SÅ«tra 1</p>
                </div>

                <div class="quote-block">
                    <p class="sharada">ğ‘†±ğ‘‡€ğ‘†®ğ‘†¼ğ‘†–ğ‘‡€ğ‘†—ğ‘†ªğ‘†³ ğ‘†±ğ‘‡€ğ‘†®ğ‘†¯ğ‘†‘ğ‘‡€ğ‘† ğ‘†´ğ‘†¥ğ‘‡€ğ‘†«ğ‘†‘ğ‘†³ğ‘†¯ğ‘†¤ğ‘†¼</p>
                    <p class="iast">svecchayÄ svaÅ›aktiprakÄÅ›ane</p>
                    <p class="quote-translation">"By its own will, it manifests its own power."</p>
                    <p class="quote-source">â€” TantrÄloka</p>
                </div>

                <div class="quote-block">
                    <p class="sharada">ğ‘†¥ğ‘‡€ğ‘†«ğ‘† ğ‘‡€ğ‘†ªğ‘†¨ğ‘†´ğ‘†˜ğ‘‡€ğ‘†šğ‘†³ ğ‘†²ğ‘†¸ğ‘†¢ğ‘†ªğ‘†©ğ‘‡€</p>
                    <p class="iast">pratyabhijÃ±Ä há¹›dayam</p>
                    <p class="quote-translation">"Recognition is the heart."</p>
                    <p class="quote-source">â€” Ká¹£emarÄja</p>
                </div>
            </div>

            <div class="description">
                <p>
                    The Proust Questionnaire, born in late 18th/19th-century European salons, wills its
                    metempsychosis here at aformulationoftruth.com for the edification and enlightenment
                    of a culture in dire straits. We may regard each question as a threshold (<em>dvÄra</em>),
                    each answer a seed for recognition (<em>pratyabhijÃ±Ä</em>). Respond, then forget the
                    questions and how you answered. Let time work its alchemy. And when you return to them,
                    a former self awaits. Your self no longer because, like a stranger, some of those responses
                    you could not fathom. And in rereading them, you recognize an aspect of our nature.
                    Language is the means we have to suggest one Self toward a more perfected treatment of
                    one another.
                </p>
                <p>
                    Each question opens a threshold; each answer plants a seed for recognition. Respond,
                    then forget. Only to return to encounter a stranger who speaks in your nameâ€”words now
                    opaque, with certainties foreign. This is not failure but structure: the subject is
                    more often elsewhere, barred from itself by the language through which a cultural
                    evolution speaks.
                </p>
                <p>
                    What we call 'self-knowledge' is retroactive, a fiction we construct in the
                    return<a href="#fn1" class="footnote-ref"><sup>1</sup></a>. Yet somethingâ€”desire,
                    egoâ€”transmits along though the nonce. Languageâ€”insufficient though it seems with its
                    slips of the tongue that betray truer depthsâ€”remains the only means we have to incline
                    one speaking being toward another. Not to perfect understanding, for there exists nothing
                    to perfect, but to the recognition that we are all, equally, subjects of this same habit speech.
                </p>
            </div>

            <div class="footnotes">
                <ol>
                    <li id="fn1">
                        <strong>Literal return</strong> â€” Coming back to the questionnaire years later, re-reading your old answers.<br>
                        <strong>Retroaction</strong> (<em>NachtrÃ¤glichkeit</em>) â€” Meaning is always constructed backwards. You don't know what you meant until later. The trauma, the truth, the significance arrives <em>aprÃ¨s-coup</em>â€”after the fact. Your past answers only become meaningful when you return to interpret them.<br>
                        <strong>The return of the repressed</strong> â€” What you couldn't say, what slipped out, what you avoidedâ€”it comes back. Your old answers reveal not what you consciously meant but what was speaking through you.<br>
                        <strong>The eternal return of the signifier</strong> â€” We're caught in circuits of repetition. You return to the same questions, thinking you've changed, only to find the same structures, the same patterns, the same impossible desire inscribed differently.
                    </li>
                </ol>
            </div>

            <div class="features">
                <div class="feature">
                    <h3>35 Questions</h3>
                    <p>Inquiries spanning virtue, fault, dreams, and desires</p>
                </div>
                <div class="feature">
                    <h3>Privacy-First Auto-Save</h3>
                    <p>Your reflections preserved as you write, secured with AES-256 encryption. No one can ever again view what is recorded at A Formulation of Truth, unless you so choose.</p>
                </div>
                <div class="feature">
                    <h3>PDF Export</h3>
                    <p>Generate a document & behold the capaciousness of consciousness</p>
                </div>
                <div class="feature sign-in-feature">
                    <h3>Begin</h3>
                    <form id="sign-in-form" class="sign-in-form">
                        <input type="email" name="email" placeholder="Enter your email" required>
                        <button type="submit">Send Magic Link</button>
                    </form>
                    <p class="sign-in-note">We'll send you a link to sign inâ€”no password needed.</p>
                </div>
            </div>

            <div class="languages">
                <h4>Available In</h4>
                <p class="language-list">
                    English Â· à¤¸à¤‚à¤¸à¥à¤•à¥ƒà¤¤à¤®à¥ Â· à®¤à®®à®¿à®´à¯ Â· à¤¹à¤¿à¤¨à¥à¤¦à¥€ Â· à²•à²¨à³à²¨à²¡ Â· EspaÃ±ol
                </p>
            </div>

            <div class="cta-section">
                <a href="https://aformulationoftruth.com" class="cta-button">
                    Begin Your Inquiry
                </a>
                <p class="cta-note">
                    Enter through the Bhairava Gateway
                </p>
            </div>
        </main>

        <footer>
            <p class="sanskrit-verse">
                à¤šà¤¿à¤¤à¤¿à¤ƒ à¤¸à¥à¤µà¤¤à¤¨à¥à¤¤à¥à¤°à¤¾ à¤µà¤¿à¤¶à¥à¤µà¤¸à¤¿à¤¦à¥à¤§à¤¿à¤¹à¥‡à¤¤à¥à¤ƒ
            </p>
            <p class="verse-translation">
                "Consciousness, freely acting, is the cause of the manifestation of everything."
                <br>
                â€” PratyabhijÃ±Ähá¹›dayam, SÅ«tra 1
            </p>
            <p class="attribution">
                A Formulation of Truth
            </p>
        </footer>
    </div>

    <script>
        document.getElementById('sign-in-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const form = e.target;
            const button = form.querySelector('button');
            const email = form.querySelector('input[name="email"]').value;

            // Remove any existing message
            const existingMsg = form.parentElement.querySelector('.sign-in-message');
            if (existingMsg) existingMsg.remove();

            button.disabled = true;
            button.textContent = 'Sending...';

            try {
                const response = await fetch('/api/auth/magic-link', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email })
                });

                const data = await response.json();

                const msg = document.createElement('p');
                msg.className = 'sign-in-message ' + (response.ok ? 'success' : 'error');
                msg.textContent = response.ok
                    ? 'Check your email for the magic link.'
                    : (data.error || 'Something went wrong. Please try again.');
                form.parentElement.appendChild(msg);

                if (response.ok) {
                    form.reset();
                }
            } catch (err) {
                const msg = document.createElement('p');
                msg.className = 'sign-in-message error';
                msg.textContent = 'Network error. Please try again.';
                form.parentElement.appendChild(msg);
            } finally {
                button.disabled = false;
                button.textContent = 'Send Magic Link';
            }
        });
    </script>
</body>
</html>
